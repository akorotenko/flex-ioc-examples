<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:spicefactory="http://www.spicefactory.org/parsley/flex"
	height="100%"
	width="100%">

	<spicefactory:Configure/>   
	<mx:Metadata>
		[Event("select")]
	</mx:Metadata>
		   
	<mx:Script>
	<![CDATA[
		import com.adobe.cairngorm.control.CairngormEvent;
		import com.adobe.cairngorm.control.CairngormEventDispatcher;
		import com.adobe.cairngorm.samples.store.model.Products;

		import mx.controls.dataGridClasses.DataGridColumn;
		import mx.formatters.CurrencyFormatter;
												
		[Inject]
		[Bindable]
		public var productsHolder : Products;
		
		[Inject]
		public var currencyFormatter : CurrencyFormatter;
		
		public static var SELECT_EVENT : String = "select";
		
		private function format( item : Object, column : DataGridColumn ) : String
		{
			return currencyFormatter.format( item.price );
		}
				
		public function updateSelectedProduct( event : Object ) : void 
		{
			productsHolder.selectedItem = event.target.selectedItem;
			//CairngormEventDispatcher.getInstance().dispatchEvent( new CairngormEvent( SELECT_EVENT ) );
		}		
	 ]]>
	</mx:Script>
 
	<mx:DataGrid id="dataGridComp"
		dataProvider="{ productsHolder.products }"
	   change="updateSelectedProduct( event );"
		dragEnabled="true" 
	   width="100%" height="100%">
	    
	    <mx:columns>
	        <mx:Array>
	            <mx:DataGridColumn dataField="name" 
	            				   headerText="Name" 
	            				   width="300" />
	            				   
	            <mx:DataGridColumn dataField="price" 
	            				   labelFunction="format" 
	            				   headerText="Price" 
	            				   textAlign="right" />
	        </mx:Array>
	    </mx:columns>
	</mx:DataGrid>

</mx:Canvas>
